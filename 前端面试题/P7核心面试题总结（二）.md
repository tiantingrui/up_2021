# P7核心面试题总结（二）

#### 1. 说一下工作中解决过的比较困难的问题（说一下自己项目中比较有亮点的地方）

```
平时学习或者工作中，最好有记笔记的习惯，遇到了什么问题, 自己一步一步怎么解决的? 到时候 无论是写简历准备面试, 还是碰到类似的问题, 都可以快速查找。学习一定要包含输入和输出
```



#### 2. 你了解浏览器的事件循环吗？

```
由浅入深挖掘问题~ http://latentflip.com/loupe 代码执行的可视化工具 
为什么有事件循环？ 
单线程： JavaScript的主要用途是与用户互动，以及操作DOM。如果它是多线程的会有很多复杂的问题 要处理，比如有两个线程同时操作DOM，一个线程删除了当前的DOM节点，一个线程是要操 作当前的DOM阶段，最后以哪个线程的操作为准？为了避免这种，所以JS是单线程的。即使 H5提出了web worker标准，它有很多限制，受主线程控制，是主线程的子线程。 
非阻塞：通过 event loop 实现。 
宏任务和微任务 
宏任务和微任务 
为什么要引入微任务，只有一种类型的任务不行么？
⻚面渲染事件，各种IO的完成事件等随时被添加到任务队列中，一直会保持先进先出的原则执 行，我们不能准确地控制这些事件被添加到任务队列中的位置。但是这个时候突然有高优先级 的任务需要尽快执行，那么一种类型的任务就不合适了，所以引入了微任务队列。 
浏览器里的事件循环 
关于微任务和宏任务在浏览器的执行顺序是这样的：
执行一只task（宏任务） 
执行完micro-task队列 （微任务） 
如此循环往复下去 常⻅的 task（宏任务） 
比如：setTimeout、setInterval、script（整体代码）、 I/O 操作、UI 渲染等。 
常⻅的 micro-task 比如: new Promise().then(回调)、MutationObserver(html5新特性) 等。

Node里的事件循环 

大体的task（宏任务）执行顺序是这样的： 
timers定时器：本阶段执行已经安排的 setTimeout() 和 setInterval() 的回调函数。 
Pending callbacks待定回调：执行延迟到下一个循环迭代的 I/O 回调。 
idle, prepare：仅系统内部使用。 
Poll 轮询：检索新的 I/O 事件;执行与 I/O 相关的回调（几乎所有情况下，除了关闭的回调函 数，它们由计时器和 setImmediate() 排定的之外），其余情况 node 将在此处阻塞。 
check 检测：setImmediate() 回调函数在这里执行。 
close callbacks 关闭的回调函数：一些准备关闭的回调函数，如：socket.on(‘close’, …)。 
微任务和宏任务在Node的执行顺序 
Node 10以前： 
执行完一个阶段的所有任务 
执行完nextTick队列里面的内容 
然后执行完微任务队列的内容 
Node 11以后： 
和浏览器的行为统一了，都是每执行一个宏任务就执行完微任务队列。
```



#### 3. 事件冒泡和捕获机制了解多少？

1. 基本概念

2. window.addEventListener 监听的是什么阶段的事件？

3. 平时工作有哪些场景用到了这个机制？写一个事件委托看看？

4. 现在有这么一个场景, 一个历史⻚面, 上面有若干按钮等点击逻辑, 每个按钮都有自己的click事 

   件。现在新需求来了, 突然给每一个访问用户添加了banned这个属性, 如果为true, 则代表此用 

   户被封禁了。被封禁用户不可操作⻚面上的任何内容, 点击⻚面内的任何一处, 都弹窗提示您已 

   被封禁



#### 4. 工作中用过防抖和节流吗？

函数防抖（debounce）：当持续触发事件时，一定时间段内没有再触发事件，事件处理函数 

才会执行一次，如果设定的时间到来之前，又一次触发了事件，就重新开始延时。如下图，持 

续触发scroll事件时，并不执行handle函数，当1000毫秒内没有触发scroll事件时，才会延时 

触发scroll事件。 debounce.webp 



函数节流（throttle）：当持续触发事件时，保证一定时间段内只调用一次事件处理函数。节 

流通俗解释就比如我们水⻰头放水，阀⻔一打开，水哗哗的往下流，秉着勤俭节约的优良传统 

美德，我们要把水⻰头关小点，最好是如我们心意按照一定规律在某个时间间隔内一滴一滴的 

往下滴。如下图，持续触发scroll事件时，并不立即执行handle函数，每隔1000毫秒才会执行 

一次handle函数。 



1. 防抖和节流的基本概念？
2. 分别适合用在什么场景？ 
3. 来写一个节流？
4. 这是写的首节流还是尾节流？





#### 5. Promise 平时用的多吗？

```
1. 如果想缓存一个promise, 怎么做? 装饰器写法怎么写? 
2. 来用primise实现promise.all, 同学们先在脑海里想一想怎么写, 身边有电脑的也可以临时写一 下试试
	放几张代码截图, 这样写对吗？这样对吗？分别有什么问题？来实现一个完美的？ 
	注意数组元素可能不全是promise 使用Promise.resolve或者判断是否是promise对象 
	注意结果的顺序问题 
	注意判断所有Promise已经执行完成 
3. 实现promise的并发控制
```



#### 6. 算法 - 接雨水问题

给定 n 个非负整数表示每个宽度为 1 的柱子的高度图，计算按此排列的柱子，下雨之后能接多 

少雨水。 

示例 1： 

输入：height = [0,1,0,2,1,0,1,3,2,1,2,1] 

输出：6 

解释：上面是由数组 [0,1,0,2,1,0,1,3,2,1,2,1] 表示的高度图，在这种情况下，可以接 6 个单 

位的雨水（蓝色部分表示雨水）。 

示例 2： 

输入：height = [4,2,0,3,2,5] 

输出：9 